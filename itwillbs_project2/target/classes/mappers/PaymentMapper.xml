<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project2.mapper.PaymentMapper">

<!-- <resultMap type="com.itwillbs.domain.MemberVO" id="memberMap"> -->
<!--   <id property="userid" column="userid"/> -->
<!--   	 <result property="userid" column="userid"/> -->
<!--   	 <result property="userpw" column="userpw"/> -->
<!--   	 <result property="username" column="username"/> -->
<!--   	 <result property="useremail" column="useremail"/> -->
<!--   	 <result property="regdate" column="regdate"/> -->
<!--   	 <result property="updatedate" column="updatedate"/>  -->
<!--   	 1:다 -->
<!--   	<collection property="authList" resultMap="authMap"></collection> -->
<!--   </resultMap> -->
  
<!--   <resultMap type="com.itwillbs.domain.AuthVO" id="authMap"> -->
<!--   		<result property="userid" column="userid"/> -->
<!--   		<result property="auth" column="auth"/>   -->
<!--   </resultMap> -->


	<!-- 클래스를 주문한 사람 상세 내역 -->

	<!-- 회원의 모든 결제 예매 리스트 -->
	<select id="paymentList" resultType="com.project2.domain.TestVO">
		select u.user_id, u.user_num, e.exp_name, e.exp_summary_img, e.exp_num, e.exp_capacity, e.exp_price, o.order_num 
		from userTable u 
		left join order_board o 
		on u.user_num = o.user_num 
		left join experience e 
		on o.exp_name = e.exp_name 
		where user_id=#{user_id}
	</select>
	
	
	<!-- 한 회원의 결제 상세내역 -->
	<select id="paymentInfo" resultType="com.project2.domain.TestVO">
		select u.user_num, o.payment_state, e.exp_name, e.exp_place,e.exp_region, e.exp_phone, e.exp_num, o.order_cnt, o.payment_price, o.payment_method, o.payment_date 
		from userTable u 
		left join order_board o 
		on u.user_num = o.user_num 
		left join experience e 
		on o.exp_name = e.exp_name 
		where u.user_num=#{user_num} and o.order_num=#{order_num}
	</select>
	
	<!-- 사업자가 신청한 클래스의 모든 예약자 리스트로 조회 -->
	<select id="hostList" resultType="com.project2.domain.TestVO">
		select e.exp_name, e.exp_num, u.user_name, u.user_num, u.user_phone, o.order_cnt, o.payment_price, o.order_num, o.order_date, o.payment_state
		from order_board o 
		left join experience e 
		on o.exp_name = e.exp_name 
		left join userTable u 
		on o.user_num = u.user_num 
		where e.exp_num in(select exp_num from experience where user_num = #{user_num});
	</select>
	
	
	<!-- 결제 -->
	<insert id="getPayment">
		insert into payment 
		values(#{order_num},#{merchant_uid},#{buyer_email},#{buyer_name},#{buyer_tel},
		#{name},#{custom_data},#{imp_uid},#{paid_amount},#{status},default,#{pg_provider},
		#{pay_method},#{card_name})
	</insert>




</mapper>